<script>
  (function init() {
    const query = new URLSearchParams(window.location.search);
    const manager = query.get("manager");

    if (manager) {
      // Save manager to localStorage
      localStorage.setItem("superdining_manager", manager);

      // Show status text
      document.getElementById("status").textContent = "✅ Manager Verified";
      document.getElementById("message").textContent = `Hi ${manager}, redirecting...`;

      // Build final link (base link you want to open)
      const finalLink = `https://example.com/clockin?manager=${encodeURIComponent(manager)}`;

      // Use Android intent:// scheme to force "Choose Browser" prompt
      const intentLink = `intent://${finalLink.replace(/^https?:\/\//, '')}#Intent;scheme=https;end`;

      // For iOS fallback (Apple doesn’t allow browser chooser, only Safari will open)
      const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);

      setTimeout(() => {
        if (isIOS) {
          window.location.href = finalLink; // will just open Safari
        } else {
          window.location.href = intentLink; // Android will show "Open with" dialog
        }
      }, 1500);

    } else {
      document.getElementById("status").textContent = "ℹ️ Invalid Access";
      document.getElementById("message").textContent = "Please use the NFC tag or JotForm link.";
    }

    // Clean URL (hide query string from address bar)
    window.history.pushState({}, document.title, '/superdining/');
  })();
</script>



