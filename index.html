<script>
  const showDebug = false;

  function logDebug(message) {
    console.log(message);
    if (showDebug) {
      const dbg = document.getElementById("debug");
      if (dbg) {
        dbg.style.display = "block";
        dbg.innerHTML += message + "<br>";
        dbg.scrollTop = dbg.scrollHeight;
      }
    }
  }

  // Read URL params
  const urlParams = new URLSearchParams(window.location.search);
  const managerName = urlParams.get("manager");
  const outletName = urlParams.get("outlet");

  // Save manager into localStorage if provided
  if (managerName) {
    localStorage.setItem("managerName", managerName);
  }

  const savedManager = localStorage.getItem("managerName");

  // ⚡ Instantly clean URL so params don't stay visible
  if (managerName || outletName) {
    window.history.replaceState({}, document.title, window.location.pathname);
  }

  // Case A: Outlet tapped but no manager saved
  if (outletName && !savedManager) {
    document.getElementById("warning").style.display = "block";
  }

  // Case B: Both manager + outlet available → load Jotform with prefilled params
  if (outletName && savedManager) {
    const iframe = document.getElementById("jotformFrame");
    iframe.style.display = "block";

    // ✅ Use Jotform prefill instead of injection
    const jotformURL =
      "https://form.jotform.com/251891698588077" +
      "?name=" + encodeURIComponent(savedManager) +
      "&outlet=" + encodeURIComponent(outletName);

    iframe.src = jotformURL;
  }
</script>


